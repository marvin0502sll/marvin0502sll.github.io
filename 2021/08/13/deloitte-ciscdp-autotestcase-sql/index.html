<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="正则表达式函数1regexp_replace(source, pattern, replace_string, occurrence)  参数说明：● source: string类型，要替换的原始字符串。● pattern: string类型常量，要匹配的正则模式，pattern为空串时抛异常。● replace_string:string，将匹配的pattern替换成的字符串。● occurr">
<meta property="og:type" content="article">
<meta property="og:title" content="deloitte-ciscdp-autotestcase-sql">
<meta property="og:url" content="https://marvin0502sll.github.io/2021/08/13/deloitte-ciscdp-autotestcase-sql/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="正则表达式函数1regexp_replace(source, pattern, replace_string, occurrence)  参数说明：● source: string类型，要替换的原始字符串。● pattern: string类型常量，要匹配的正则模式，pattern为空串时抛异常。● replace_string:string，将匹配的pattern替换成的字符串。● occurr">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-08-13T06:59:09.000Z">
<meta property="article:modified_time" content="2021-08-31T06:51:49.253Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://marvin0502sll.github.io/2021/08/13/deloitte-ciscdp-autotestcase-sql/"/>





  <title>deloitte-ciscdp-autotestcase-sql | Hexo</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://marvin0502sll.github.io/2021/08/13/deloitte-ciscdp-autotestcase-sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">deloitte-ciscdp-autotestcase-sql</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-08-13T14:59:09+08:00">
                2021-08-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%B7%E5%8B%A4/" itemprop="url" rel="index">
                    <span itemprop="name">德勤</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%B7%E5%8B%A4/%E5%BE%B7%E5%8B%A4-%E5%AE%9D%E9%A9%AC%E9%A2%86%E6%82%A6/" itemprop="url" rel="index">
                    <span itemprop="name">德勤-宝马领悦</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a><center><font color="#7093DB" size=6 face="宋体">正则表达式</font></center></h2><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a><center><font color="#7093DB" size=6 face="宋体">函数</font></center></h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regexp_replace(source, <span class="keyword">pattern</span>, replace_string, occurrence)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>参数说明：<br>● source: string类型，要替换的原始字符串。<br>● pattern: string类型常量，要匹配的正则模式，pattern为空串时抛异常。<br>● replace_string:string，将匹配的pattern替换成的字符串。<br>● occurrence: bigint类型常量，必须大于等于0，<br>大于0：表示将第几次匹配替换成replace_string，<br>等于0：表示替换掉所有的匹配子串。<br>其它类型或小于0抛异常。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvl(表达式<span class="number">1</span>，表达式<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果表达式1为空值，NVL返回值为表达式2的值，否则返回表达式1的值。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RPAD(str,len,padstr)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>返回字符串str，右填充以字符串padstr中垫到len字符长度。如果str为大于len，返回值被缩短至len个字符</p>
</blockquote>
<h2 id="清洗规则"><a href="#清洗规则" class="headerlink" title="清洗规则"></a><center><font color="#7093DB" size=6 face="宋体">清洗规则</font></center></h2><ul>
<li><p>数字</p>
<ul>
<li><font color="FFA500">转为数字，去掉开头的0，除以100</font><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cast</span>(ltrim(price,<span class="string">&#x27;0&#x27;</span>) <span class="keyword">as</span> <span class="type">bigint</span>)<span class="operator">/</span><span class="number">100</span></span><br></pre></td></tr></table></figure></li>
<li>保留小数点后4位<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span></span><br><span class="line">	<span class="keyword">when</span> regexp_replace(num,<span class="string">&#x27;[^0-9.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="operator">=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> REGEXP_REPLACE(num,<span class="string">&#x27;[0-9.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="operator">&lt;&gt;</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> num <span class="keyword">is</span> <span class="keyword">null</span>  <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> num rlike <span class="string">&#x27;\\.&#x27;</span> <span class="keyword">then</span> rpad(substr(num,<span class="number">1</span>,instr(num,<span class="string">&#x27;.&#x27;</span>)<span class="operator">+</span><span class="number">4</span>),instr(num,<span class="string">&#x27;.&#x27;</span>)<span class="operator">+</span><span class="number">4</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">	<span class="keyword">when</span> num <span class="keyword">not</span> rlike <span class="string">&#x27;\\.&#x27;</span> <span class="keyword">then</span> concat(num,<span class="string">&#x27;.0000&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span> num,</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>日期</p>
<ul>
<li>如果不为空，格式统一为YYYY-MM-DD HH(24):MM:SS</li>
<li>大于1949-01-01，否则置空<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> startdate <span class="operator">&gt;</span> <span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">then</span> startdate <span class="keyword">end</span> start_date,</span><br></pre></td></tr></table></figure></li>
<li>大于开始时间小于当前时间，否则置空<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> </span><br><span class="line">    <span class="keyword">when</span> startdate <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> enddate <span class="keyword">between</span> startdate <span class="keyword">and</span> <span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> enddate</span><br><span class="line">    <span class="keyword">when</span> startdate <span class="keyword">is</span>  <span class="keyword">null</span> enddate <span class="keyword">between</span> <span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> <span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> enddate</span><br><span class="line"><span class="keyword">end</span> end_date,</span><br></pre></td></tr></table></figure></li>
<li>时间戳类型转换<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from_unixtime(<span class="built_in">cast</span>(time_stamp<span class="operator">/</span><span class="number">1000</span> <span class="keyword">as</span> <span class="type">bigint</span>),<span class="string">&#x27;yyyy-MM-dd HH:mm:ss&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>字符串组成</p>
<ul>
<li>仅数字组成<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">trim</span>(floorid) rlike <span class="string">&#x27;^\\d+$&#x27;</span> <span class="keyword">then</span> <span class="built_in">trim</span>(floorid) <span class="keyword">end</span> floor_id,</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">trim</span>(floorid) rlike <span class="string">&#x27;^[0-9]+$&#x27;</span> <span class="keyword">then</span> <span class="built_in">trim</span>(floorid) <span class="keyword">end</span> floor_id,</span><br></pre></td></tr></table></figure></li>
<li>17位数字、字母组成<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">trim</span>(vin17) rlike <span class="string">&#x27;^[0-9a-zA-Z]&#123;17&#125;$&#x27;</span> <span class="keyword">then</span> <span class="built_in">trim</span>(Vin17) <span class="keyword">end</span> vin_17,</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>性别</p>
<ul>
<li>性别<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> </span><br><span class="line">   	<span class="keyword">when</span> <span class="built_in">UPPER</span>(<span class="built_in">trim</span>(gender_code)) <span class="keyword">like</span> &quot;先生|男|MALE|MR&quot; <span class="keyword">OR</span> <span class="built_in">UPPER</span>(<span class="built_in">trim</span>(gender_code)) <span class="keyword">in</span> (<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;M.&#x27;</span>) <span class="keyword">then</span> <span class="string">&#x27;M&#x27;</span></span><br><span class="line">   	<span class="keyword">when</span> <span class="built_in">UPPER</span>(<span class="built_in">trim</span>(gender_code)) <span class="keyword">like</span> &quot;女|FEMALE|MS&quot; <span class="keyword">OR</span> <span class="built_in">UPPER</span>(<span class="built_in">trim</span>(gender_code)) <span class="keyword">in</span> (<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;F.&#x27;</span>) <span class="keyword">then</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">   	<span class="keyword">else</span> <span class="string">&#x27;U&#x27;</span></span><br><span class="line"><span class="keyword">end</span> gender,</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>邮箱</p>
<ul>
<li><font color="FFA500"></li>
</ul>
<ol>
<li>邮箱包括两个及以上@,只保留1个@.  </li>
<li> 邮箱包括两个连续..,去掉一个.</li>
<li>邮箱中如果@之前是.,去掉.</li>
<li>邮箱@之后是.,去掉.</li>
<li>邮箱以.开始,去掉.</li>
<li>邮箱以.结尾,去掉结尾的.</li>
<li>邮箱包括异常字符：$,%,^，空格，？，中文字符等,去掉异常字符</li>
<li>邮箱以.comcn结尾,将.comcn替换为.com.cn</li>
<li>执行以上步骤之后，如果邮箱不包括1个@和至少1个.,置为空</li>
<li>执行以上步骤之后，如果邮箱@之后不包括至少1个.,置为空</li>
<li>执行以上步骤之后，如果邮箱最后一个.之后字母数小于2,置为空</font>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">case</span> </span><br><span class="line">	<span class="keyword">when</span> length(REGEXP_REPLACE(email_address,<span class="string">&#x27;[^@]&#x27;</span>,<span class="string">&#x27;&#x27;</span>))<span class="operator">=</span><span class="number">0</span> <span class="keyword">or</span> length(REGEXP_REPLACE(email_address,<span class="string">&#x27;[^.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>))<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> length(REGEXP_REPLACE(substr(email_address,instr(email_address,<span class="string">&#x27;@&#x27;</span>)),<span class="string">&#x27;[^.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>))<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> length(substr(reverse(email_address),<span class="number">1</span>,instr(reverse(email_address),<span class="string">&#x27;.&#x27;</span>)<span class="number">-1</span>))<span class="operator">&lt;</span><span class="number">2</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> email_address rlike <span class="string">&#x27;\\.comcn$&#x27;</span> <span class="keyword">then</span> REGEXP_REPLACE(email_address,<span class="string">&#x27;\\.comcn$&#x27;</span>,<span class="string">&#x27;.com.cn&#x27;</span>) </span><br><span class="line">	<span class="keyword">else</span> email_address</span><br><span class="line"><span class="keyword">end</span> email_address,</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#补充</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">cons_guid,</span><br><span class="line">cop_id,</span><br><span class="line">communication_status,</span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line">	<span class="keyword">when</span> length(REGEXP_REPLACE(new_email_address,<span class="string">&#x27;[^@]&#x27;</span>,<span class="string">&#x27;&#x27;</span>))<span class="operator">=</span><span class="number">0</span> <span class="keyword">or</span> length(REGEXP_REPLACE(new_email_address,<span class="string">&#x27;[^.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>))<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> length(REGEXP_REPLACE(substr(new_email_address,instr(new_email_address,<span class="string">&#x27;@&#x27;</span>)),<span class="string">&#x27;[^.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>))<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> length(substr(reverse(new_email_address),<span class="number">1</span>,instr(reverse(new_email_address),<span class="string">&#x27;.&#x27;</span>)<span class="number">-1</span>))<span class="operator">&lt;</span><span class="number">2</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> new_email_address rlike <span class="string">&#x27;\\.comcn$&#x27;</span> <span class="keyword">then</span> REGEXP_REPLACE(new_email_address,<span class="string">&#x27;\\.comcn$&#x27;</span>,<span class="string">&#x27;.com.cn&#x27;</span>) </span><br><span class="line">	<span class="keyword">else</span> new_email_address</span><br><span class="line"><span class="keyword">end</span> email_address,</span><br><span class="line">communication_type,</span><br><span class="line">deleted,</span><br><span class="line">create_date,</span><br><span class="line">modify_date,</span><br><span class="line">fday</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	a.<span class="operator">*</span>,</span><br><span class="line">	<span class="keyword">case</span></span><br><span class="line">		<span class="keyword">when</span> email_address rlike <span class="string">&#x27;^\\..*\\.$&#x27;</span> <span class="keyword">then</span> regexp_replace(substr(email_address,<span class="number">2</span>,length(email_address)<span class="number">-2</span>),<span class="string">&#x27;[^A-Za-z0-9-.@_]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">		<span class="keyword">when</span> email_address rlike <span class="string">&#x27;^\\.&#x27;</span> <span class="keyword">then</span> regexp_replace(substr(email_address,<span class="number">2</span>),<span class="string">&#x27;[^A-Za-z0-9-.@_]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">		<span class="keyword">when</span> email_address rlike <span class="string">&#x27;\\.$&#x27;</span> <span class="keyword">then</span> regexp_replace(substr(email_address,<span class="number">1</span>,length(email_address)<span class="number">-1</span>),<span class="string">&#x27;[^A-Za-z0-9-.@_]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span> regexp_replace(email_address,<span class="string">&#x27;[^A-Za-z0-9-.@_]&#x27;</span>,<span class="string">&#x27;&#x27;</span>) </span><br><span class="line">	<span class="keyword">end</span> new_email_address</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	cons_guid	cons_guid,</span><br><span class="line">	cid	cop_id,</span><br><span class="line">	communication_status	communication_status,</span><br><span class="line">	REGEXP_REPLACE(REGEXP_REPLACE(concat(substr(<span class="keyword">value</span>,<span class="number">1</span>,instr(<span class="keyword">value</span>,<span class="string">&#x27;@&#x27;</span>)),REGEXP_REPLACE(substr(<span class="keyword">value</span>,instr(<span class="keyword">value</span>,<span class="string">&#x27;@&#x27;</span>)<span class="operator">+</span><span class="number">1</span>),<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;&#x27;</span>)),<span class="string">&#x27;[.]&#123;2,&#125;&#x27;</span>,<span class="string">&#x27;.&#x27;</span>),&quot;(@\\.)|(\\.@)&quot;,<span class="string">&#x27;@&#x27;</span>) email_address,</span><br><span class="line">	communication_type	communication_type,</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">trim</span>(is_delete) <span class="keyword">in</span> (<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>) <span class="keyword">then</span> <span class="built_in">trim</span>(is_delete) <span class="keyword">end</span>	deleted,</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">when</span> create_time<span class="operator">&gt;</span><span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> create_time<span class="operator">&lt;</span><span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> create_time <span class="keyword">end</span> create_date,</span><br><span class="line">	<span class="keyword">case</span> </span><br><span class="line">		<span class="keyword">when</span> create_time <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> update_time<span class="operator">&gt;=</span>create_time <span class="keyword">and</span> update_time<span class="operator">&gt;</span><span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> update_time<span class="operator">&lt;</span><span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> create_time</span><br><span class="line">		<span class="keyword">when</span> create_time <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> update_time<span class="operator">&gt;</span><span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> update_time<span class="operator">&lt;</span><span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> create_time</span><br><span class="line">	<span class="keyword">end</span> modify_date,</span><br><span class="line">	<span class="keyword">day</span>	fday</span><br><span class="line"><span class="keyword">from</span> source_cop.cop__cop_db__email)a)b;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>电话号码</p>
<ul>
<li><font color="#FFA500"></li>
</ul>
<ol>
<li>如果电话号码包括异常字符： $,%,^, ?,  _, (, ), *, @,+, 标点符号, 空格, 中文字符，英文字母等,去掉异常字符.</li>
<li>“-”后多于8位数字,置为空.</li>
<li>如果电话号码有“-”,去掉“-”.</li>
<li>如果电话号码长度为13或14位且以86或086开始,去掉开头的’0‘.</li>
<li>如果电话号码长度小于7位,置为空.</li>
<li>如果电话号码长度大于20位,置为空.</font>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">case</span>	</span><br><span class="line">	 <span class="keyword">when</span> regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^\\+861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> REPLACE(regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;)</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^1[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> CONCAT(<span class="string">&#x27;86&#x27;</span>,regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;))</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^01[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> CONCAT(<span class="string">&#x27;86&#x27;</span>,substr(regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="number">2</span>))</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^0861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> substr(regexp_replace(ua_mobile,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="number">2</span>)</span><br><span class="line"><span class="keyword">end</span> mobile_phone_number,</span><br></pre></td></tr></table></figure>
<!--
case    
when regexp_replace(ua_mobile,"[^+0-9]","") REGEXP '^\\+861[3-9][0-9]{9}$' THEN REPLACE(regexp_replace(ua_mobile,"[^+0-9]",""),'+','')
when regexp_replace(ua_mobile,"[^+0-9]","") REGEXP '^861[3-9][0-9]{9}$' THEN regexp_replace(ua_mobile,"[^+0-9]","")
when regexp_replace(ua_mobile,"[^+0-9]","") REGEXP '^1[3-9][0-9]{9}$' THEN CONCAT('86',regexp_replace(ua_mobile,"[^+0-9]",""))
when regexp_replace(ua_mobile,"[^+0-9]","") REGEXP '^01[3-9][0-9]{9}$' THEN CONCAT('86',substr(regexp_replace(ua_mobile,"[^+0-9]",""),2))
when regexp_replace(ua_mobile,"[^+0-9]","") REGEXP '^0861[3-9][0-9]{9}$' THEN substr(regexp_replace(ua_mobile,"[^+0-9]",""),2)
end mobile_phone_number,</li>
</ol>
</li>
</ul>
<p>–&gt;<br>    <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#补充传真机</span><br><span class="line">#上面那个为</span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line">	<span class="keyword">when</span> regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^-0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>) rlike <span class="string">&#x27;-&#x27;</span> <span class="keyword">and</span> length(substr(regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^-0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),instr(regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^-0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),<span class="string">&#x27;-&#x27;</span>)<span class="operator">+</span><span class="number">1</span>))<span class="operator">&lt;=</span><span class="number">8</span> <span class="keyword">then</span> regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^-0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>) rlike <span class="string">&#x27;-&#x27;</span> <span class="keyword">and</span> length(substr(regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^-0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),instr(regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^-0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),<span class="string">&#x27;-&#x27;</span>)<span class="operator">+</span><span class="number">1</span>))<span class="operator">&gt;</span><span class="number">8</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">WHEN</span> regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^\\+861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> REPLACE(regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">	<span class="keyword">WHEN</span> regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;)</span><br><span class="line">	<span class="keyword">WHEN</span> regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^1[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> CONCAT(<span class="string">&#x27;86&#x27;</span>,regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;))</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^01[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> CONCAT(<span class="string">&#x27;86&#x27;</span>,substr(regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="number">2</span>))</span><br><span class="line">	<span class="keyword">when</span> regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^0861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> substr(regexp_replace(T1.x_add_fax_num,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">when</span> length(regexp_replace(T1.x_add_fax_num,&quot;[^0-9]&quot;,&quot;&quot;))<span class="operator">&gt;</span><span class="number">20</span> <span class="keyword">or</span> length(regexp_replace(T1.x_add_fax_num,&quot;[^0-9]&quot;,&quot;&quot;))<span class="operator">&lt;</span><span class="number">7</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">else</span> regexp_replace(T1.x_add_fax_num,<span class="string">&#x27;[^0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span> t1_x_add_fax_number,</span><br></pre></td></tr></table></figure></p>
<ul>
<li>名字<ul>
<li><font color="FFA500"></li>
</ul>
<ol>
<li>去除 $,%,^, ?,  _, (, ), *, @,+,- 标点符号,数字  </li>
<li>如果名包括称谓 (e.g. “先生”, “女士”, “教授”, “经理”,’ 副经理’,’总经理’,’经理’,’ 总监’,’老师’,’小姐’,’姐’,’太太’,’大哥’,’哥’,’兄’,’总’,’夫人’,’科长’,’司机’,’贵宾’,’朋友’,’大爷’ ,’ 老公’ ,’ 老婆’,’ 丈夫’,’ 儿子’,’ 老爸’ ,’ 包工头’,’地址’ ,’ 客户不留’),去掉称谓  </li>
<li>经过前两步处理，如果姓是名的一部分且姓和名不相同,在名中删除与姓相同的内容.  </li>
<li>经过前两步处理，如果姓和名相同,取第二位以后的部分.  </li>
<li>经过前两步处理，如果nvl(姓,’’)&amp;nvl(名,’’)为“无”或“无无”，则将姓和名置为空</font>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">select</span> </span><br><span class="line">cop_id,</span><br><span class="line"><span class="comment">--old_mobile_phone_number,</span></span><br><span class="line">mobile_phone_number,</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> nvl(last_name_1,<span class="string">&#x27;&#x27;</span>) <span class="keyword">in</span> (<span class="string">&#x27;无&#x27;</span>,<span class="string">&#x27;无无&#x27;</span>) <span class="keyword">and</span> nvl(first_name_1,<span class="string">&#x27;&#x27;</span>) <span class="keyword">in</span> (<span class="string">&#x27;无&#x27;</span>,<span class="string">&#x27;无无&#x27;</span>)  <span class="keyword">then</span> <span class="keyword">null</span> <span class="keyword">else</span> last_name_1 <span class="keyword">end</span> last_name,</span><br><span class="line">gender,</span><br><span class="line">state,</span><br><span class="line">create_date,</span><br><span class="line">modify_date,</span><br><span class="line"><span class="comment">--old_first_name,</span></span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> nvl(last_name_1,<span class="string">&#x27;&#x27;</span>) <span class="keyword">in</span> (<span class="string">&#x27;无&#x27;</span>,<span class="string">&#x27;无无&#x27;</span>) <span class="keyword">and</span> nvl(first_name_1,<span class="string">&#x27;&#x27;</span>) <span class="keyword">in</span> (<span class="string">&#x27;无&#x27;</span>,<span class="string">&#x27;无无&#x27;</span>)  <span class="keyword">then</span> <span class="keyword">null</span> <span class="keyword">else</span> first_name_1 <span class="keyword">end</span> first_name,</span><br><span class="line">gcid,</span><br><span class="line">ucid,</span><br><span class="line">wechat_head_img_url,</span><br><span class="line">wechat_nick_name,</span><br><span class="line"><span class="comment">--old_birth_date,</span></span><br><span class="line">birth_date,</span><br><span class="line">base_head_img_url,</span><br><span class="line">fday,</span><br><span class="line">channel_sources</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	a.<span class="operator">*</span>,</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">when</span> first_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> last_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> first_name<span class="operator">&lt;&gt;</span>last_name <span class="keyword">then</span> replace(first_name,last_name,<span class="string">&#x27;&#x27;</span>) <span class="keyword">when</span> first_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> last_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> first_name<span class="operator">=</span>last_name <span class="keyword">then</span> <span class="built_in">SUBSTRING</span>(<span class="built_in">cast</span>(first_name <span class="keyword">as</span> string),<span class="number">2</span>)	<span class="keyword">else</span> first_name <span class="keyword">end</span> first_name_1,</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">when</span> first_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> last_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> first_name<span class="operator">&lt;&gt;</span>last_name <span class="keyword">then</span> replace(last_name,first_name,<span class="string">&#x27;&#x27;</span>) <span class="keyword">when</span> first_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> last_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> first_name<span class="operator">=</span>last_name <span class="keyword">then</span> <span class="built_in">SUBSTRING</span>(<span class="built_in">cast</span>(last_name <span class="keyword">as</span> string),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">when</span>  first_name <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> last_name <span class="keyword">end</span> last_name_1</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	cid	cop_id,</span><br><span class="line">	mobile old_mobile_phone_number,</span><br><span class="line">	<span class="keyword">case</span>	</span><br><span class="line">		<span class="keyword">WHEN</span> regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^\\+861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> REPLACE(regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">		<span class="keyword">WHEN</span> regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;)</span><br><span class="line">		<span class="keyword">WHEN</span> regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^1[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> CONCAT(<span class="string">&#x27;86&#x27;</span>,regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;))</span><br><span class="line">		<span class="keyword">when</span> regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^01[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> CONCAT(<span class="string">&#x27;86&#x27;</span>,substr(regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="number">2</span>))</span><br><span class="line">		<span class="keyword">when</span> regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;) REGEXP <span class="string">&#x27;^0861[3-9][0-9]&#123;9&#125;$&#x27;</span> <span class="keyword">THEN</span> substr(regexp_replace(mobile,&quot;[^+0-9]&quot;,&quot;&quot;),<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">end</span> mobile_phone_number,</span><br><span class="line">	sur_name old_last_name,</span><br><span class="line">	REGEXP_REPLACE(sur_name,&quot;[^\u4e00-\u9fa5a-zA-Z]|先生|女士|教授|经理|副经理|总经理|经理|总监|老师|小姐|姐|太太|大哥|哥|兄|总|夫人|科长|司机|贵宾|朋友|大爷|老公|老婆|丈夫|儿子|老爸|包工头|地址|客户不留&quot;,&quot;&quot;) last_name,</span><br><span class="line">	<span class="keyword">case</span> </span><br><span class="line">		<span class="keyword">when</span> gender <span class="operator">=</span><span class="string">&#x27;Company&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;U&#x27;</span></span><br><span class="line">		<span class="keyword">when</span> gender <span class="keyword">in</span> (<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;else&#x27;</span>) <span class="keyword">then</span> <span class="string">&#x27;U&#x27;</span></span><br><span class="line">		<span class="keyword">when</span> gender <span class="keyword">in</span> (<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;先生&#x27;</span>,<span class="string">&#x27;M 先生&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;MR.&#x27;</span>,<span class="string">&#x27;M.&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>) <span class="keyword">then</span> <span class="string">&#x27;M&#x27;</span></span><br><span class="line">		<span class="keyword">when</span> gender <span class="keyword">in</span> (<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;女士&#x27;</span>,<span class="string">&#x27;F 女士&#x27;</span>,<span class="string">&#x27;F 小姐&#x27;</span>,<span class="string">&#x27;MS&#x27;</span>,<span class="string">&#x27;Ms&#x27;</span>,<span class="string">&#x27;MS.&#x27;</span>,<span class="string">&#x27;Ms.&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>) <span class="keyword">then</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">		<span class="keyword">when</span> gender <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> gender<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">		<span class="keyword">else</span> <span class="string">&#x27;U&#x27;</span></span><br><span class="line">	<span class="keyword">end</span> gender,</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">when</span> state <span class="keyword">in</span> (<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>) <span class="keyword">then</span> state <span class="keyword">end</span>	state,</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">when</span> create_time<span class="operator">&gt;</span><span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> create_time<span class="operator">&lt;</span><span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> create_time <span class="keyword">end</span> create_date,</span><br><span class="line">	<span class="keyword">case</span> </span><br><span class="line">		<span class="keyword">when</span> create_time <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> update_time<span class="operator">&gt;=</span>create_time <span class="keyword">and</span> update_time<span class="operator">&gt;</span><span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> update_time<span class="operator">&lt;</span><span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> create_time</span><br><span class="line">		<span class="keyword">when</span> create_time <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> update_time<span class="operator">&gt;</span><span class="string">&#x27;1949-01-01&#x27;</span> <span class="keyword">and</span> update_time<span class="operator">&lt;</span><span class="built_in">CURRENT_TIMESTAMP</span>() <span class="keyword">then</span> create_time</span><br><span class="line">	<span class="keyword">end</span> modify_date,</span><br><span class="line">	given_name old_first_name,</span><br><span class="line">	REGEXP_REPLACE(given_name,&quot;[^\u4e00-\u9fa5a-zA-Z]|先生|女士|教授|经理|副经理|总经理|经理|总监|老师|小姐|姐|太太|大哥|哥|兄|总|夫人|科长|司机|贵宾|朋友|大爷|老公|老婆|丈夫|儿子|老爸|包工头|地址|客户不留&quot;,&quot;&quot;)	first_name,</span><br><span class="line">	gcid	gcid,</span><br><span class="line">	ucid	ucid,</span><br><span class="line">	wx_head_img_url	wechat_head_img_url,</span><br><span class="line">	wx_nick_name	wechat_nick_name,</span><br><span class="line">	birth old_birth_date,</span><br><span class="line">	<span class="keyword">case</span> </span><br><span class="line">		<span class="keyword">when</span> concat(substr(birth,<span class="number">1</span>,<span class="number">4</span>),<span class="string">&#x27;-&#x27;</span>,substr(birth,<span class="number">5</span>,<span class="number">2</span>),<span class="string">&#x27;-&#x27;</span>,substr(birth,<span class="number">7</span>,<span class="number">2</span>)) <span class="operator">&lt;</span> <span class="string">&#x27;1900-01-01&#x27;</span> <span class="keyword">then</span> <span class="keyword">null</span> </span><br><span class="line">		<span class="keyword">when</span> concat(substr(birth,<span class="number">1</span>,<span class="number">4</span>),<span class="string">&#x27;-&#x27;</span>,substr(birth,<span class="number">5</span>,<span class="number">2</span>),<span class="string">&#x27;-&#x27;</span>,substr(birth,<span class="number">7</span>,<span class="number">2</span>)) <span class="operator">&gt;</span> create_time <span class="keyword">or</span> birth <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> birth<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">then</span> substr(<span class="built_in">trim</span>(gcid),<span class="number">7</span>,<span class="number">8</span>)</span><br><span class="line">		<span class="keyword">else</span> concat(substr(birth,<span class="number">1</span>,<span class="number">4</span>),<span class="string">&#x27;-&#x27;</span>,substr(birth,<span class="number">5</span>,<span class="number">2</span>),<span class="string">&#x27;-&#x27;</span>,substr(birth,<span class="number">7</span>,<span class="number">2</span>),<span class="string">&#x27; 00:00:00&#x27;</span>)</span><br><span class="line">	<span class="keyword">end</span>	birth_date,</span><br><span class="line">	base_head_img_url	base_head_img_url,</span><br><span class="line">	<span class="keyword">day</span>	fday,</span><br><span class="line">	lp_from	channel_sources</span><br><span class="line"><span class="keyword">from</span> source_cop.cop__cop_db__sys_user)a)b;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li>地址<ul>
<li><font color="FF4500"></li>
</ul>
<ol>
<li>如果城市名字跟Codeforcity+city+district表中一致,保留原值.  </li>
<li>如果城市名字在Codeforcity+city+district表中，但是没有”市”，“区”,添加后缀.  </li>
<li>如果城市名字包括标准名字，但是还有其他字符,只保留标准名字.  </li>
<li>如果城市名字只包括数字、字母、或者只有 “省”  or “市”  or “区” or “县”,置为空.  </li>
<li>如果城市名字去掉“市”或“区”后，在下面列表中，则转为对应的值:<br>塘沽：滨海新区<br>崇文：东城区……</font>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">case</span> </span><br><span class="line">	<span class="keyword">when</span> b.city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> b.city</span><br><span class="line">	<span class="keyword">when</span> b.city <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> e.new_city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> e.new_city</span><br><span class="line">	<span class="keyword">when</span> b.city <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> REGEXP_REPLACE(a.city,&quot;[^\u4e00-\u9fa5]|新区|区|市|自治州|地区&quot;,&quot;&quot;)<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> a.city <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(a.city) <span class="operator">=</span><span class="string">&#x27;&#x27;</span><span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">else</span> REGEXP_REPLACE(a.city,<span class="string">&#x27;[^\u4e00-\u9fa5]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span> city</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--dwc_dim_cus_gcdm_customer_address_t clean</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line">	<span class="keyword">when</span> b.city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> b.city</span><br><span class="line">	<span class="keyword">when</span> b.city <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> e.new_city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> e.new_city</span><br><span class="line">	<span class="keyword">when</span> b.city <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> REGEXP_REPLACE(a.city,&quot;[^\u4e00-\u9fa5]|新区|区|市|自治州|地区&quot;,&quot;&quot;)<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">when</span> a.city <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(a.city) <span class="operator">=</span><span class="string">&#x27;&#x27;</span><span class="keyword">then</span> <span class="keyword">null</span></span><br><span class="line">	<span class="keyword">else</span> REGEXP_REPLACE(a.city,<span class="string">&#x27;[^\u4e00-\u9fa5]&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span> city,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line">	<span class="keyword">when</span> b.province <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> b.province</span><br><span class="line">	<span class="keyword">when</span> b.province <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> c.province <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> c.province</span><br><span class="line"><span class="keyword">end</span> province</span><br><span class="line"><span class="keyword">from</span> source_gcdm.gcdm_bp_address a</span><br><span class="line"><span class="comment">--城市关联</span></span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> province,city <span class="keyword">from</span> raw.raw_upload_province_city_district_map_t <span class="keyword">where</span> city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> )b</span><br><span class="line"><span class="keyword">on</span> REGEXP_REPLACE(a.city,&quot;[^\u4e00-\u9fa5]|新区|区|市|自治州|地区&quot;,&quot;&quot;)<span class="operator">=</span>regexp_replace(b.city,&quot;新区|区|市|自治州|地区&quot;,&quot;&quot;)</span><br><span class="line"><span class="keyword">and</span> REGEXP_REPLACE(a.city,&quot;[^\u4e00-\u9fa5]|新区|区|市|自治州|地区&quot;,&quot;&quot;)<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">and</span> a.city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">and</span> b.province <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;北京市&#x27;</span>,<span class="string">&#x27;上海市&#x27;</span>,<span class="string">&#x27;重庆市&#x27;</span>)</span><br><span class="line"><span class="keyword">and</span> a.city <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;朝阳区&#x27;</span>)</span><br><span class="line"><span class="comment">--省份关联</span></span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> province <span class="keyword">from</span> raw.raw_upload_province_city_district_map_t <span class="keyword">where</span> city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> )c</span><br><span class="line"><span class="keyword">on</span> REGEXP_REPLACE(a.regioncode,&quot;[^\u4e00-\u9fa5]|省|市|自治区|特别行政区&quot;,&quot;&quot;)<span class="operator">=</span>regexp_replace(c.province,&quot;省|市|自治区|特别行政区&quot;,&quot;&quot;)</span><br><span class="line"><span class="keyword">and</span> REGEXP_REPLACE(a.regioncode,&quot;[^\u4e00-\u9fa5]|省|市|自治区|特别行政区&quot;,&quot;&quot;)<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">and</span> a.regioncode <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"><span class="comment">--城市额外关联</span></span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span>  <span class="string">&#x27;塘沽&#x27;</span> old_city,  <span class="string">&#x27;滨海新区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;崇文&#x27;</span> old_city,  <span class="string">&#x27;东城区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;宣武&#x27;</span> old_city,  <span class="string">&#x27;西城区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;巢湖&#x27;</span> old_city,  <span class="string">&#x27;合肥市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;永康&#x27;</span> old_city,  <span class="string">&#x27;金华市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;三河&#x27;</span> old_city,  <span class="string">&#x27;廊坊市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;江阴&#x27;</span> old_city,  <span class="string">&#x27;无锡市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;莱芜&#x27;</span> old_city,  <span class="string">&#x27;济南市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;闸北&#x27;</span> old_city,  <span class="string">&#x27;静安区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;任丘&#x27;</span> old_city,  <span class="string">&#x27;沧州市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;慈溪&#x27;</span> old_city,  <span class="string">&#x27;宁波市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;襄樊&#x27;</span> old_city,  <span class="string">&#x27;襄阳市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;大港&#x27;</span> old_city,  <span class="string">&#x27;滨海新区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;迁安&#x27;</span> old_city,  <span class="string">&#x27;唐山市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;思茅&#x27;</span> old_city,  <span class="string">&#x27;普洱市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;静海县&#x27;</span> old_city,  <span class="string">&#x27;静海区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;晋州&#x27;</span> old_city,  <span class="string">&#x27;石家庄市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;密云县&#x27;</span> old_city,  <span class="string">&#x27;密云区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;卢湾&#x27;</span> old_city,  <span class="string">&#x27;黄浦区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;余姚&#x27;</span> old_city,  <span class="string">&#x27;宁波市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;蓟县&#x27;</span> old_city,  <span class="string">&#x27;蓟州区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;太仓&#x27;</span> old_city,  <span class="string">&#x27;苏州市&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;崇明县&#x27;</span> old_city,  <span class="string">&#x27;崇明区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;开县&#x27;</span> old_city,  <span class="string">&#x27;开州区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;汉沽&#x27;</span> old_city,  <span class="string">&#x27;滨海新区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;大足县&#x27;</span> old_city,  <span class="string">&#x27;大足区&#x27;</span> new_city <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span>  <span class="string">&#x27;璧山县&#x27;</span> old_city,  <span class="string">&#x27;璧山区&#x27;</span> new_city)e</span><br><span class="line"><span class="keyword">on</span> REGEXP_REPLACE(a.city,&quot;[^\u4e00-\u9fa5]|市|区&quot;,&quot;&quot;)<span class="operator">=</span>e.old_city</span><br><span class="line"><span class="keyword">and</span> REGEXP_REPLACE(a.city,&quot;[^\u4e00-\u9fa5]|新区|区|市|自治州|地区&quot;,&quot;&quot;)<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">and</span> a.city <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><font color="#FF4500"></li>
</ul>
<ol>
<li>如果包括小写字母,将全部字母转为大写.  </li>
<li>如果值与国家代码表CODE一致,保留原值.  </li>
<li>如果值包含国家代码表中的code或value_zh，则将值转为国家代码表中的code  </li>
<li>其余情况置为空</font>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AD|安道尔&quot;	<span class="keyword">then</span> &quot;AD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AE|阿联酋&quot;	<span class="keyword">then</span> &quot;AE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AF|阿富汗&quot;	<span class="keyword">then</span> &quot;AF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AG|安提瓜和巴布达&quot;	<span class="keyword">then</span> &quot;AG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AI|安圭拉&quot;	<span class="keyword">then</span> &quot;AI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AL|阿尔巴尼亚&quot;	<span class="keyword">then</span> &quot;AL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AM|亚美尼亚&quot;	<span class="keyword">then</span> &quot;AM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AN|荷属安的列斯群岛&quot;	<span class="keyword">then</span> &quot;AN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AO|安哥拉&quot;	<span class="keyword">then</span> &quot;AO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AQ|南极&quot;	<span class="keyword">then</span> &quot;AQ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AR|阿根廷&quot;	<span class="keyword">then</span> &quot;AR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AS|美属萨摩亚&quot;	<span class="keyword">then</span> &quot;AS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AT|奥地利&quot;	<span class="keyword">then</span> &quot;AT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AU|澳大利亚&quot;	<span class="keyword">then</span> &quot;AU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AW|阿鲁巴&quot;	<span class="keyword">then</span> &quot;AW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CL|智利&quot;	<span class="keyword">then</span> &quot;CL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CM|喀麦隆&quot;	<span class="keyword">then</span> &quot;CM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CN|中国&quot;	<span class="keyword">then</span> &quot;CN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CO|哥伦比亚&quot;	<span class="keyword">then</span> &quot;CO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CR|哥斯达黎加&quot;	<span class="keyword">then</span> &quot;CR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CS|塞尔维亚和黑山&quot;	<span class="keyword">then</span> &quot;CS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CU|古巴&quot;	<span class="keyword">then</span> &quot;CU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CV|库拉索&quot;	<span class="keyword">then</span> &quot;CV&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CX|圣诞岛&quot;	<span class="keyword">then</span> &quot;CX&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CY|塞浦路斯&quot;	<span class="keyword">then</span> &quot;CY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CZ|捷克&quot;	<span class="keyword">then</span> &quot;CZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;DE|德国&quot;	<span class="keyword">then</span> &quot;DE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;DJ|吉布提&quot;	<span class="keyword">then</span> &quot;DJ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;DK|丹麦&quot;	<span class="keyword">then</span> &quot;DK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;DM|多米尼克&quot;	<span class="keyword">then</span> &quot;DM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;DO|多米尼加&quot;	<span class="keyword">then</span> &quot;DO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;DZ|阿尔及利亚&quot;	<span class="keyword">then</span> &quot;DZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;EC|厄瓜多尔&quot;	<span class="keyword">then</span> &quot;EC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;EE|爱沙尼亚&quot;	<span class="keyword">then</span> &quot;EE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;EG|埃及&quot;	<span class="keyword">then</span> &quot;EG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;EH|阿拉伯撒哈拉民主共和国&quot;	<span class="keyword">then</span> &quot;EH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ER|厄立特里亚&quot;	<span class="keyword">then</span> &quot;ER&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ES|西班牙&quot;	<span class="keyword">then</span> &quot;ES&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ET|埃塞俄比亚&quot;	<span class="keyword">then</span> &quot;ET&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;EU|欧盟&quot;	<span class="keyword">then</span> &quot;EU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;FI|芬兰&quot;	<span class="keyword">then</span> &quot;FI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;FJ|斐济&quot;	<span class="keyword">then</span> &quot;FJ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;FK|马尔维纳斯群岛&quot;	<span class="keyword">then</span> &quot;FK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;FM|密克罗尼西亚联邦&quot;	<span class="keyword">then</span> &quot;FM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;FO|法罗群岛&quot;	<span class="keyword">then</span> &quot;FO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;FR|法国&quot;	<span class="keyword">then</span> &quot;FR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GA|加蓬&quot;	<span class="keyword">then</span> &quot;GA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GB|英国&quot;	<span class="keyword">then</span> &quot;GB&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GD|格林纳达&quot;	<span class="keyword">then</span> &quot;GD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GE|格鲁吉亚&quot;	<span class="keyword">then</span> &quot;GE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GF|法属圭亚那&quot;	<span class="keyword">then</span> &quot;GF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GH|加纳&quot;	<span class="keyword">then</span> &quot;GH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GI|直布罗陀&quot;	<span class="keyword">then</span> &quot;GI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GL|格陵兰&quot;	<span class="keyword">then</span> &quot;GL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GM|冈比亚&quot;	<span class="keyword">then</span> &quot;GM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GN|几内亚&quot;	<span class="keyword">then</span> &quot;GN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GP|瓜德罗普&quot;	<span class="keyword">then</span> &quot;GP&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GQ|赤道几内亚&quot;	<span class="keyword">then</span> &quot;GQ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GR|希腊&quot;	<span class="keyword">then</span> &quot;GR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GS|南乔治亚和南桑威奇群岛&quot;	<span class="keyword">then</span> &quot;GS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GT|危地马拉&quot;	<span class="keyword">then</span> &quot;GT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GU|Guam&quot;	<span class="keyword">then</span> &quot;GU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GW|几内亚比绍&quot;	<span class="keyword">then</span> &quot;GW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;GY|圭亚那&quot;	<span class="keyword">then</span> &quot;GY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;HK|香港&quot;	<span class="keyword">then</span> &quot;HK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;HM|赫德岛和麦克唐纳群岛&quot;	<span class="keyword">then</span> &quot;HM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;HN|洪都拉斯&quot;	<span class="keyword">then</span> &quot;HN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;HR|克罗地亚&quot;	<span class="keyword">then</span> &quot;HR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;HT|海地&quot;	<span class="keyword">then</span> &quot;HT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;HU|匈牙利&quot;	<span class="keyword">then</span> &quot;HU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ID|印度尼西亚&quot;	<span class="keyword">then</span> &quot;ID&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IE|爱尔兰&quot;	<span class="keyword">then</span> &quot;IE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IL|以色列&quot;	<span class="keyword">then</span> &quot;IL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IN|印度&quot;	<span class="keyword">then</span> &quot;IN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IO|英属印度洋领地&quot;	<span class="keyword">then</span> &quot;IO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IQ|伊拉克&quot;	<span class="keyword">then</span> &quot;IQ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IR|伊朗&quot;	<span class="keyword">then</span> &quot;IR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IS|冰岛&quot;	<span class="keyword">then</span> &quot;IS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;IT|意大利&quot;	<span class="keyword">then</span> &quot;IT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;JM|牙买加&quot;	<span class="keyword">then</span> &quot;JM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;JO|约旦&quot;	<span class="keyword">then</span> &quot;JO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;JP|日本&quot;	<span class="keyword">then</span> &quot;JP&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KE|肯尼亚&quot;	<span class="keyword">then</span> &quot;KE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KG|吉尔吉斯斯坦&quot;	<span class="keyword">then</span> &quot;KG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KH|柬埔寨&quot;	<span class="keyword">then</span> &quot;KH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KI|基里巴斯&quot;	<span class="keyword">then</span> &quot;KI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KM|科摩罗&quot;	<span class="keyword">then</span> &quot;KM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KN|圣基茨和尼维斯&quot;	<span class="keyword">then</span> &quot;KN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KP|朝鲜&quot;	<span class="keyword">then</span> &quot;KP&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KR|韩国&quot;	<span class="keyword">then</span> &quot;KR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KW|科威特&quot;	<span class="keyword">then</span> &quot;KW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KY|开曼群岛&quot;	<span class="keyword">then</span> &quot;KY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;KZ|哈萨克斯坦&quot;	<span class="keyword">then</span> &quot;KZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LA|老挝&quot;	<span class="keyword">then</span> &quot;LA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LB|黎巴嫩&quot;	<span class="keyword">then</span> &quot;LB&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LC|St. Lucia&quot;	<span class="keyword">then</span> &quot;LC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LI|列支敦士登&quot;	<span class="keyword">then</span> &quot;LI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LK|斯里兰卡&quot;	<span class="keyword">then</span> &quot;LK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LR|利比里亚&quot;	<span class="keyword">then</span> &quot;LR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LS|莱索托&quot;	<span class="keyword">then</span> &quot;LS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LT|立陶宛&quot;	<span class="keyword">then</span> &quot;LT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LU|卢森堡&quot;	<span class="keyword">then</span> &quot;LU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LV|拉脱维亚&quot;	<span class="keyword">then</span> &quot;LV&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;LY|利比亚&quot;	<span class="keyword">then</span> &quot;LY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MA|摩洛哥&quot;	<span class="keyword">then</span> &quot;MA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MC|摩纳哥&quot;	<span class="keyword">then</span> &quot;MC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MD|摩尔多瓦&quot;	<span class="keyword">then</span> &quot;MD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ME|蒙特内哥罗&quot;	<span class="keyword">then</span> &quot;ME&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MG|马达加斯加&quot;	<span class="keyword">then</span> &quot;MG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MH|马绍尔群岛&quot;	<span class="keyword">then</span> &quot;MH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MK|马其顿&quot;	<span class="keyword">then</span> &quot;MK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ML|马里&quot;	<span class="keyword">then</span> &quot;ML&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MM|缅甸&quot;	<span class="keyword">then</span> &quot;MM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MN|蒙古国&quot;	<span class="keyword">then</span> &quot;MN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MO|澳门&quot;	<span class="keyword">then</span> &quot;MO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MP|北马里亚纳群岛&quot;	<span class="keyword">then</span> &quot;MP&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MQ|马提尼克&quot;	<span class="keyword">then</span> &quot;MQ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MR|毛里塔尼亚&quot;	<span class="keyword">then</span> &quot;MR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MS|蒙特塞拉特&quot;	<span class="keyword">then</span> &quot;MS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MT|马耳他&quot;	<span class="keyword">then</span> &quot;MT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MU|毛里求斯&quot;	<span class="keyword">then</span> &quot;MU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MV|马尔代夫&quot;	<span class="keyword">then</span> &quot;MV&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MW|Malawi&quot;	<span class="keyword">then</span> &quot;MW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MX|墨西哥&quot;	<span class="keyword">then</span> &quot;MX&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MY|马来西亚&quot;	<span class="keyword">then</span> &quot;MY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;MZ|莫桑比克&quot;	<span class="keyword">then</span> &quot;MZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NA|纳米比亚&quot;	<span class="keyword">then</span> &quot;NA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NC|新喀里多尼亚&quot;	<span class="keyword">then</span> &quot;NC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NE|尼日尔&quot;	<span class="keyword">then</span> &quot;NE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NF|诺福克岛&quot;	<span class="keyword">then</span> &quot;NF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NG|尼日利亚&quot;	<span class="keyword">then</span> &quot;NG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NI|尼加拉瓜&quot;	<span class="keyword">then</span> &quot;NI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NL|荷兰&quot;	<span class="keyword">then</span> &quot;NL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NO|挪威&quot;	<span class="keyword">then</span> &quot;NO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NP|尼泊尔&quot;	<span class="keyword">then</span> &quot;NP&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NR|瑙鲁&quot;	<span class="keyword">then</span> &quot;NR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NT|北约&quot;	<span class="keyword">then</span> &quot;NT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NU|纽埃&quot;	<span class="keyword">then</span> &quot;NU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;NZ|新西兰&quot;	<span class="keyword">then</span> &quot;NZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;OM|阿曼&quot;	<span class="keyword">then</span> &quot;OM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;OR|Orange&quot;	<span class="keyword">then</span> &quot;OR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PA|巴拿马&quot;	<span class="keyword">then</span> &quot;PA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PE|秘鲁&quot;	<span class="keyword">then</span> &quot;PE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PF|法属波利尼西亚&quot;	<span class="keyword">then</span> &quot;PF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PG|巴布亚新几内亚&quot;	<span class="keyword">then</span> &quot;PG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PH|菲律宾&quot;	<span class="keyword">then</span> &quot;PH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PK|巴基斯坦&quot;	<span class="keyword">then</span> &quot;PK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PL|波兰&quot;	<span class="keyword">then</span> &quot;PL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PM|圣皮埃尔和密克隆&quot;	<span class="keyword">then</span> &quot;PM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PN|皮特凯恩群岛&quot;	<span class="keyword">then</span> &quot;PN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PR|波多黎各&quot;	<span class="keyword">then</span> &quot;PR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PS|巴勒斯坦&quot;	<span class="keyword">then</span> &quot;PS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PT|葡萄牙&quot;	<span class="keyword">then</span> &quot;PT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PW|帕劳&quot;	<span class="keyword">then</span> &quot;PW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;PY|巴拉圭&quot;	<span class="keyword">then</span> &quot;PY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;QA|卡塔尔&quot;	<span class="keyword">then</span> &quot;QA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;RE|留尼汪&quot;	<span class="keyword">then</span> &quot;RE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;RO|罗马尼亚&quot;	<span class="keyword">then</span> &quot;RO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;RS|塞尔维亚&quot;	<span class="keyword">then</span> &quot;RS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;RU|俄罗斯&quot;	<span class="keyword">then</span> &quot;RU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;RW|卢旺达&quot;	<span class="keyword">then</span> &quot;RW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SA|沙特阿拉伯&quot;	<span class="keyword">then</span> &quot;SA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SB|所罗门群岛&quot;	<span class="keyword">then</span> &quot;SB&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SC|塞舌尔&quot;	<span class="keyword">then</span> &quot;SC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SD|苏丹&quot;	<span class="keyword">then</span> &quot;SD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SE|瑞典&quot;	<span class="keyword">then</span> &quot;SE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SG|新加坡&quot;	<span class="keyword">then</span> &quot;SG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SH|圣赫勒拿&quot;	<span class="keyword">then</span> &quot;SH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SI|斯洛文尼亚&quot;	<span class="keyword">then</span> &quot;SI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SJ|Svalbard&quot;	<span class="keyword">then</span> &quot;SJ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SK|斯洛伐克&quot;	<span class="keyword">then</span> &quot;SK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SL|塞拉利昂&quot;	<span class="keyword">then</span> &quot;SL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SM|圣马力诺&quot;	<span class="keyword">then</span> &quot;SM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SN|塞内加尔&quot;	<span class="keyword">then</span> &quot;SN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SO|索马里&quot;	<span class="keyword">then</span> &quot;SO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SR|苏里南&quot;	<span class="keyword">then</span> &quot;SR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ST|圣多美和普林西比&quot;	<span class="keyword">then</span> &quot;ST&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SV|萨尔瓦多&quot;	<span class="keyword">then</span> &quot;SV&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SY|叙利亚&quot;	<span class="keyword">then</span> &quot;SY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;SZ|斯威士兰&quot;	<span class="keyword">then</span> &quot;SZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TC|特克斯和凯科斯群岛&quot;	<span class="keyword">then</span> &quot;TC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TD|乍得&quot;	<span class="keyword">then</span> &quot;TD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TF|法属南部领地&quot;	<span class="keyword">then</span> &quot;TF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TG|多哥&quot;	<span class="keyword">then</span> &quot;TG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TH|泰国&quot;	<span class="keyword">then</span> &quot;TH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TJ|塔吉克斯坦&quot;	<span class="keyword">then</span> &quot;TJ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TK|托克劳&quot;	<span class="keyword">then</span> &quot;TK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TL|东帝汶&quot;	<span class="keyword">then</span> &quot;TL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TM|土库曼斯坦&quot;	<span class="keyword">then</span> &quot;TM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TN|突尼西亚&quot;	<span class="keyword">then</span> &quot;TN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TO|汤加&quot;	<span class="keyword">then</span> &quot;TO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TR|土耳其&quot;	<span class="keyword">then</span> &quot;TR&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TT|特立尼达及托巴哥&quot;	<span class="keyword">then</span> &quot;TT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TV|图瓦卢&quot;	<span class="keyword">then</span> &quot;TV&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TW|台湾&quot;	<span class="keyword">then</span> &quot;TW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;TZ|坦桑尼亚&quot;	<span class="keyword">then</span> &quot;TZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;UA|乌克兰&quot;	<span class="keyword">then</span> &quot;UA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;UG|乌干达&quot;	<span class="keyword">then</span> &quot;UG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;UM|美国本土外小岛屿&quot;	<span class="keyword">then</span> &quot;UM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;UN|联合国&quot;	<span class="keyword">then</span> &quot;UN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;US|美国&quot;	<span class="keyword">then</span> &quot;US&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;UY|乌拉圭&quot;	<span class="keyword">then</span> &quot;UY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;UZ|乌兹别克斯坦&quot;	<span class="keyword">then</span> &quot;UZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VA|梵蒂冈&quot;	<span class="keyword">then</span> &quot;VA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VC|圣文森及格瑞那丁&quot;	<span class="keyword">then</span> &quot;VC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VE|委内瑞拉&quot;	<span class="keyword">then</span> &quot;VE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VG|英属维京群岛&quot;	<span class="keyword">then</span> &quot;VG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VI|美属维京群岛&quot;	<span class="keyword">then</span> &quot;VI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VN|越南&quot;	<span class="keyword">then</span> &quot;VN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;VU|瓦努阿图&quot;	<span class="keyword">then</span> &quot;VU&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;WF|瓦利斯和富图纳&quot;	<span class="keyword">then</span> &quot;WF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;WS|萨摩亚&quot;	<span class="keyword">then</span> &quot;WS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;YE|也门&quot;	<span class="keyword">then</span> &quot;YE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;YT|马约特&quot;	<span class="keyword">then</span> &quot;YT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ZA|南非&quot;	<span class="keyword">then</span> &quot;ZA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ZM|赞比亚&quot;	<span class="keyword">then</span> &quot;ZM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;ZW|津巴布韦&quot;	<span class="keyword">then</span> &quot;ZW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BS|巴哈马&quot;	<span class="keyword">then</span> &quot;BS&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BT|不丹&quot;	<span class="keyword">then</span> &quot;BT&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BV|布韦岛&quot;	<span class="keyword">then</span> &quot;BV&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BW|博茨瓦纳&quot;	<span class="keyword">then</span> &quot;BW&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BY|白俄罗斯&quot;	<span class="keyword">then</span> &quot;BY&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BZ|伯利兹&quot;	<span class="keyword">then</span> &quot;BZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CA|加拿大&quot;	<span class="keyword">then</span> &quot;CA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CC|科科斯（基林）群岛&quot;	<span class="keyword">then</span> &quot;CC&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CD|刚果（金）&quot;	<span class="keyword">then</span> &quot;CD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CF|中非共和国&quot;	<span class="keyword">then</span> &quot;CF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CG|刚果（布）&quot;	<span class="keyword">then</span> &quot;CG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CH|瑞士&quot;	<span class="keyword">then</span> &quot;CH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CI|科特迪瓦&quot;	<span class="keyword">then</span> &quot;CI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;CK|库克群岛&quot;	<span class="keyword">then</span> &quot;CK&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AX|奥兰&quot;	<span class="keyword">then</span> &quot;AX&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;AZ|阿塞拜疆&quot;	<span class="keyword">then</span> &quot;AZ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BA|波斯尼亚和黑塞哥维那&quot;	<span class="keyword">then</span> &quot;BA&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BB|巴巴多斯&quot;	<span class="keyword">then</span> &quot;BB&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BD|孟加拉国国&quot;	<span class="keyword">then</span> &quot;BD&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BE|比利时&quot;	<span class="keyword">then</span> &quot;BE&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BF|布基纳法索&quot;	<span class="keyword">then</span> &quot;BF&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BG|保加利亚&quot;	<span class="keyword">then</span> &quot;BG&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BH|巴林&quot;	<span class="keyword">then</span> &quot;BH&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BI|布隆迪&quot;	<span class="keyword">then</span> &quot;BI&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BJ|贝宁&quot;	<span class="keyword">then</span> &quot;BJ&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BL|圣巴泰勒米&quot;	<span class="keyword">then</span> &quot;BL&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BM|百慕大&quot;	<span class="keyword">then</span> &quot;BM&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BN|文莱&quot;	<span class="keyword">then</span> &quot;BN&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BO|玻利维亚&quot;	<span class="keyword">then</span> &quot;BO&quot;</span><br><span class="line"><span class="keyword">when</span> <span class="built_in">upper</span>(<span class="built_in">trim</span>(a.country)) rlike	&quot;BR|巴西&quot;	<span class="keyword">then</span> &quot;BR&quot;</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">as</span> country,</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/07/09/hexo-github-next%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" rel="next" title="Hexo + GitHub + NexT搭建博客">
                <i class="fa fa-chevron-left"></i> Hexo + GitHub + NexT搭建博客
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7Carchive">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">正则表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">2.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%85%E6%B4%97%E8%A7%84%E5%88%99"><span class="nav-number">3.</span> <span class="nav-text">清洗规则</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
